# Vue3 + GAS å°ˆæ¡ˆé‡æ§‹èªªæ˜

## ğŸ“‹ é‡æ§‹å…§å®¹

æœ¬å°ˆæ¡ˆå·²é‡æ§‹ç‚ºæœ€ç°¡åŒ–çš„ç‰ˆæœ¬ï¼Œåªä¿ç•™å¿…è¦åŠŸèƒ½ï¼Œæ–¹ä¾¿å¾ŒçºŒé–‹ç™¼æ–°æ¨¡çµ„ã€‚

### âœ… ä¿ç•™çš„æ¨¡çµ„

1. **ç™»å…¥æ¨¡çµ„** (`src/views/login`)

   - ä½¿ç”¨ GAS å¾Œç«¯é€²è¡Œèº«ä»½é©—è­‰
   - æ”¯æ´é–‹ç™¼ç’°å¢ƒçš„ Mock è³‡æ–™

2. **é¦–é  Dashboard** (`src/views/dashboard`)

   - ç³»çµ±ä¸»é é¢
   - å¯è‡ªè¨‚å…§å®¹

3. **è©¦ç®—è¡¨ç®¡ç†** (`src/views/spreadsheet`)

   - Google Spreadsheet çš„ CRUD æ“ä½œç¯„ä¾‹
   - å¯ä½œç‚ºæ–°å¢å…¶ä»–æ¨¡çµ„çš„åƒè€ƒ

4. **éŒ¯èª¤é é¢** (`src/views/error-page`)

   - 403 ç„¡æ¬Šé™é é¢
   - 404 æ‰¾ä¸åˆ°é é¢

5. **æ ¸å¿ƒçµ„ä»¶**
   - Layout ä½ˆå±€ç³»çµ±
   - å´é‚Šæ¬„å°èˆª
   - æ¨™ç±¤é åŠŸèƒ½

### âŒ å·²ç§»é™¤çš„ç¯„ä¾‹

- Table è¡¨æ ¼ç¯„ä¾‹
- Hook Demo ç¯„ä¾‹
- Permission æ¬Šé™ç¯„ä¾‹
- Menu å¤šç´šè·¯ç”±ç¯„ä¾‹
- UnoCSS ç¯„ä¾‹
- Product ç”¢å“ç®¡ç†ç¯„ä¾‹
- axios ä¾è³´ï¼ˆæ”¹ç”¨ç´” GASï¼‰
- vxe-table ç›¸é—œä¾è³´

## ğŸš€ å¿«é€Ÿé–‹å§‹

### é–‹ç™¼æµç¨‹

æœ¬å°ˆæ¡ˆæ¡ç”¨ **ç›´æ¥éƒ¨ç½²åˆ° GAS æ¸¬è©¦** çš„é–‹ç™¼æ–¹å¼ï¼š

```bash
# 1. å®‰è£ä¾è³´
pnpm install

# 2. å»ºç½®ä¸¦éƒ¨ç½²åˆ° GAS
pnpm run deploy:gas

# 3. åœ¨ç€è¦½å™¨é–‹å•Ÿæ¸¬è©¦éƒ¨ç½²ç¶²å€ï¼ˆ.../devï¼‰æŸ¥çœ‹æœ€æ–°çµæœ

# 4. ç¢ºèªç„¡èª¤å¾Œï¼Œå»ºç«‹æ–°çš„æ­£å¼éƒ¨ç½²ç‰ˆæœ¬ï¼ˆ.../execï¼‰
```

**é‡è¦æç¤ºï¼š**

- ä¸ä½¿ç”¨æœ¬åœ°é–‹ç™¼ä¼ºæœå™¨ï¼ˆpnpm devï¼‰
- æ¯æ¬¡ä¿®æ”¹å¾Œéƒ½éœ€è¦é‡æ–°éƒ¨ç½²åˆ° GAS
- å…ˆä½¿ç”¨æ¸¬è©¦éƒ¨ç½² `.../dev` ç¶²å€é€²è¡Œé–‹ç™¼æ¸¬è©¦
- ç¢ºèªåŠŸèƒ½æ­£ç¢ºç„¡èª¤å¾Œï¼Œå†å»ºç«‹æ­£å¼éƒ¨ç½² `.../exec` ç‰ˆæœ¬
- æ¸…é™¤ç€è¦½å™¨å¿«å–ä»¥ç¢ºä¿è¼‰å…¥æœ€æ–°ç‰ˆæœ¬

## ğŸ“ å°ˆæ¡ˆçµæ§‹

```
src/
â”œâ”€â”€ api/                    # API å±¤
â”‚   â”œâ”€â”€ login/             # ç™»å…¥ API
â”‚   â””â”€â”€ spreadsheet/       # è©¦ç®—è¡¨ API
â”œâ”€â”€ views/                 # é é¢çµ„ä»¶
â”‚   â”œâ”€â”€ login/            # ç™»å…¥é é¢
â”‚   â”œâ”€â”€ dashboard/        # é¦–é 
â”‚   â”œâ”€â”€ spreadsheet/      # è©¦ç®—è¡¨ç®¡ç†
â”‚   â”œâ”€â”€ error-page/       # éŒ¯èª¤é é¢
â”‚   â””â”€â”€ redirect/         # é‡å®šå‘é é¢
â”œâ”€â”€ utils/                 # å·¥å…·å‡½æ•¸
â”‚   â”œâ”€â”€ gas-service.js    # GAS æœå‹™ï¼ˆæ ¸å¿ƒï¼‰
â”‚   â””â”€â”€ service.js        # HTTP æœå‹™ï¼ˆå·²åœç”¨ï¼‰
â”œâ”€â”€ router/                # è·¯ç”±é…ç½®
â”œâ”€â”€ store/                 # Pinia ç‹€æ…‹ç®¡ç†
â””â”€â”€ layouts/               # ä½ˆå±€çµ„ä»¶

gas/
â”œâ”€â”€ main.js               # GAS ä¸»å…¥å£
â”œâ”€â”€ login.js              # ç™»å…¥ç›¸é—œå‡½æ•¸
â”œâ”€â”€ spreadsheet.js        # è©¦ç®—è¡¨ç›¸é—œå‡½æ•¸
â””â”€â”€ index.html            # HTML æ¨¡æ¿
```

## ğŸ“ æ–°å¢æ¨¡çµ„æµç¨‹

### 1. å‰µå»º API

åœ¨ `src/api/` å»ºç«‹æ–°è³‡æ–™å¤¾ï¼Œä¾‹å¦‚ `my-module/index.js`ï¼š

```javascript
import { callGasFunction } from "@/utils/gas-service"

export function getMyData() {
  return callGasFunction("getMyData")
}

export function saveMyData(data) {
  return callGasFunction("saveMyData", data)
}
```

### 2. å‰µå»º Vue çµ„ä»¶

åœ¨ `src/views/` å»ºç«‹æ–°è³‡æ–™å¤¾ï¼Œä¾‹å¦‚ `my-module/index.vue`ï¼š

```vue
<script setup>
import { ref, onMounted } from "vue"
import { ElMessage } from "element-plus"
import { getMyData } from "@/api/my-module"

const data = ref([])

const loadData = async () => {
  try {
    const response = await getMyData()
    if (response.code === 0) {
      data.value = response.data
      ElMessage.success("è¼‰å…¥æˆåŠŸ")
    }
  } catch (error) {
    ElMessage.error("è¼‰å…¥å¤±æ•—ï¼š" + error.message)
  }
}

onMounted(() => {
  loadData()
})
</script>

<template>
  <div class="app-container">
    <el-card>
      <h2>æˆ‘çš„æ¨¡çµ„</h2>
      <!-- æ‚¨çš„å…§å®¹ -->
    </el-card>
  </div>
</template>

<style scoped>
.app-container {
  padding: 20px;
}
</style>
```

### 3. æ–°å¢è·¯ç”±

åœ¨ `src/router/index.js` çš„ `constantRoutes` é™£åˆ—ä¸­æ–°å¢ï¼š

```javascript
{
  path: "/my-module",
  component: Layouts,
  redirect: "/my-module/index",
  children: [
    {
      path: "index",
      component: () => import("@/views/my-module/index.vue"),
      name: "MyModule",
      meta: {
        title: "æˆ‘çš„æ¨¡çµ„",
        svgIcon: "component"  // å¯é¸æ“‡çš„åœ–ç¤º
      }
    }
  ]
}
```

### 4. å‰µå»º GAS å‡½æ•¸ï¼ˆé‡è¦ï¼ï¼‰

åœ¨ `gas/` è³‡æ–™å¤¾å»ºç«‹æ–°æª”æ¡ˆï¼Œä¾‹å¦‚ `my-module.js`ï¼š

```javascript
/**
 * å–å¾—æˆ‘çš„è³‡æ–™
 * @returns {Object} å›æ‡‰ç‰©ä»¶
 */
// eslint-disable-next-line no-unused-vars
function getMyData() {
  try {
    // æ‚¨çš„ GAS é‚è¼¯
    const data = []

    return {
      code: 0,
      data: data,
      message: "æˆåŠŸ"
    }
  } catch (error) {
    return {
      code: 1,
      data: null,
      message: "éŒ¯èª¤: " + error.message
    }
  }
}

/**
 * å„²å­˜æˆ‘çš„è³‡æ–™
 * @param {any} data - è¦å„²å­˜çš„è³‡æ–™
 * @returns {Object} å›æ‡‰ç‰©ä»¶
 */
// eslint-disable-next-line no-unused-vars
function saveMyData(data) {
  try {
    // æ‚¨çš„ GAS é‚è¼¯

    return {
      code: 0,
      data: null,
      message: "å„²å­˜æˆåŠŸ"
    }
  } catch (error) {
    return {
      code: 1,
      data: null,
      message: "éŒ¯èª¤: " + error.message
    }
  }
}
```

### 5. æ¸¬è©¦éƒ¨ç½²

```bash
# å»ºç½®ä¸¦éƒ¨ç½²åˆ° GAS
pnpm run deploy:gas
```

éƒ¨ç½²å®Œæˆå¾Œï¼š

1. åœ¨ç€è¦½å™¨é–‹å•Ÿæ¸¬è©¦éƒ¨ç½²ç¶²å€ï¼ˆ`.../dev`ï¼‰æ¸¬è©¦åŠŸèƒ½
2. ç¢ºèªåŠŸèƒ½æ­£å¸¸é‹ä½œ
3. å¦‚éœ€æ­£å¼ç™¼å¸ƒï¼Œå»ºç«‹æ–°çš„éƒ¨ç½²ç‰ˆæœ¬ï¼ˆ`.../exec`ï¼‰

## ğŸ”§ GAS å›æ‡‰æ ¼å¼

æ‰€æœ‰ GAS å‡½æ•¸æ‡‰è©²è¿”å›çµ±ä¸€çš„æ ¼å¼ï¼š

```javascript
{
  code: 0,           // 0 è¡¨ç¤ºæˆåŠŸï¼Œå…¶ä»–è¡¨ç¤ºéŒ¯èª¤
  data: any,         // å›å‚³çš„è³‡æ–™
  message: "è¨Šæ¯"    // æç¤ºè¨Šæ¯
}
```

## ğŸ“± è©¦ç®—è¡¨ç®¡ç†ç¯„ä¾‹

å°ˆæ¡ˆä¸­å·²åŒ…å«å®Œæ•´çš„ Google Spreadsheet ç®¡ç†ç¯„ä¾‹ï¼Œå±•ç¤ºäº†ï¼š

- âœ… è®€å–è©¦ç®—è¡¨è³‡æ–™
- âœ… æ–°å¢è³‡æ–™åˆ—
- âœ… ç·¨è¼¯è³‡æ–™åˆ—
- âœ… åˆªé™¤è³‡æ–™åˆ—
- âœ… åˆ‡æ›å·¥ä½œè¡¨
- âœ… å–å¾—æ‰€æœ‰å·¥ä½œè¡¨åç¨±

æ‚¨å¯ä»¥åƒè€ƒ `src/views/spreadsheet/index.vue` å’Œ `gas/spreadsheet.js` ä¾†äº†è§£å¦‚ä½•å¯¦ä½œã€‚

## ğŸ’¡ é–‹ç™¼å»ºè­°

1. **é–‹ç™¼æµç¨‹**

   - åŒæ­¥é–‹ç™¼å‰ç«¯çµ„ä»¶å’Œ GAS å‡½æ•¸
   - æ¯æ¬¡ä¿®æ”¹å¾Œä½¿ç”¨ `pnpm run deploy:gas` éƒ¨ç½²
   - åœ¨ç€è¦½å™¨æ¸¬è©¦ä¸¦é©—è­‰åŠŸèƒ½
   - æ¸…é™¤ç€è¦½å™¨å¿«å–ç¢ºä¿è¼‰å…¥æœ€æ–°ç‰ˆæœ¬

2. **éŒ¯èª¤è™•ç†**

   - ä½¿ç”¨ try-catch æ•ç²éŒ¯èª¤
   - è¿”å›çµ±ä¸€çš„éŒ¯èª¤æ ¼å¼
   - ä½¿ç”¨ ElMessage é¡¯ç¤ºæç¤ºè¨Šæ¯
   - åœ¨ GAS å‡½æ•¸ä¸­è©³ç´°è¨˜éŒ„éŒ¯èª¤

3. **é™¤éŒ¯æŠ€å·§**

   - ä½¿ç”¨ GAS ç·¨è¼¯å™¨çš„ Logger.log() æŸ¥çœ‹æ—¥èªŒ
   - åœ¨ç€è¦½å™¨æ§åˆ¶å°æŸ¥çœ‹å‰ç«¯éŒ¯èª¤
   - ä½¿ç”¨ç¶²è·¯æ¨™ç±¤æª¢æŸ¥ API å‘¼å«

4. **ç‹€æ…‹ç®¡ç†**

   - ç°¡å–®ç‹€æ…‹ä½¿ç”¨ ref/reactive
   - å…¨åŸŸç‹€æ…‹ä½¿ç”¨ Pinia store

5. **æ¨£å¼**
   - ä½¿ç”¨ Element Plus çµ„ä»¶
   - Scoped CSS é¿å…æ¨£å¼æ±¡æŸ“
   - ä¿æŒä»‹é¢ä¸€è‡´æ€§

## ğŸ”’ ç™»å…¥ç³»çµ±

ç™»å…¥ç³»çµ±ä½¿ç”¨ Cookie å„²å­˜ Tokenï¼ŒGAS å¾Œç«¯é€²è¡Œé©—è­‰ã€‚

### ä¿®æ”¹ç™»å…¥é‚è¼¯

å¦‚éœ€è‡ªè¨‚ç™»å…¥é‚è¼¯ï¼Œè«‹ä¿®æ”¹ï¼š

- å‰ç«¯ï¼š`src/views/login/index.vue`
- APIï¼š`src/api/login/index.js`
- GASï¼š`gas/login.js`

## ğŸ“¦ éƒ¨ç½²æ³¨æ„äº‹é …

1. ç¢ºèªå·²å®‰è£ clasp ä¸¦å®Œæˆæˆæ¬Š
2. ç¢ºèª `.clasp.json` é…ç½®æ­£ç¢º
3. ä½¿ç”¨ `pnpm run deploy:gas` éƒ¨ç½²
4. éƒ¨ç½²å¾Œå…ˆä½¿ç”¨ `.../dev` æ¸¬è©¦ç¶²å€é€²è¡Œæ¸¬è©¦
5. ç¢ºèªç„¡èª¤å¾Œï¼Œå»ºç«‹æ–°çš„éƒ¨ç½²ç‰ˆæœ¬ä½¿ç”¨ `.../exec` æ­£å¼ç¶²å€

## ğŸ†˜ å¸¸è¦‹å•é¡Œ

### Q: å¦‚ä½•æ–°å¢å´é‚Šæ¬„åœ–ç¤ºï¼Ÿ

A: å¯ä½¿ç”¨ Element Plus åœ–ç¤ºï¼ˆ`elIcon`ï¼‰æˆ–è‡ªè¨‚ SVG åœ–ç¤ºï¼ˆ`svgIcon`ï¼‰ã€‚

### Q: å¦‚ä½•è™•ç† GAS çš„éåŒæ­¥æ“ä½œï¼Ÿ

A: GAS å¾Œç«¯æœƒè‡ªå‹•è™•ç†ï¼Œå‰ç«¯ä½¿ç”¨ async/await å³å¯ã€‚

### Q: é–‹ç™¼éç¨‹å¦‚ä½•æ¸¬è©¦ï¼Ÿ

A: æ¯æ¬¡ä¿®æ”¹å¾ŒåŸ·è¡Œ `pnpm run deploy:gas` éƒ¨ç½²åˆ° GASï¼Œç„¶å¾Œåœ¨ç€è¦½å™¨é–‹å•Ÿ `.../dev` æ¸¬è©¦ç¶²å€æŸ¥çœ‹çµæœã€‚ç¢ºèªç„¡èª¤å¾Œå†å»ºç«‹ `.../exec` æ­£å¼ç‰ˆæœ¬ã€‚

### Q: å¦‚ä½•é™¤éŒ¯ GAS å‡½æ•¸ï¼Ÿ

A: ä½¿ç”¨ GAS ç·¨è¼¯å™¨çš„ Logger.log() æˆ– console.log() é€²è¡Œé™¤éŒ¯ã€‚

## ğŸ“„ æˆæ¬Š

æœ¬å°ˆæ¡ˆåŸºæ–¼åŸå§‹æ¨¡æ¿é‡æ§‹ï¼Œä¿ç•™åŸå§‹æˆæ¬Šæ¢æ¬¾ã€‚

---

å¦‚æœ‰å•é¡Œï¼Œè«‹åƒè€ƒ Google Apps Script å®˜æ–¹æ–‡ä»¶æˆ– Vue3 å®˜æ–¹æ–‡ä»¶ã€‚
